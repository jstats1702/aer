---
title: "Taller 2"
author: 
- Juan Sosa PhD
- Webpage https://sites.google.com/view/juansosa/ 
- YouTube https://www.youtube.com/c/JuanSosa1702 
- GitHub  https://github.com/jstats1702 
- Rpubs   https://rpubs.com/jstats1702
date: ""
output:
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. El grado de un nodo en una red tanto dirigida como no dirigida se puede calcular fácilmente a partir de la matriz de adyacencia $\mathbf{Y}=[y_{i,j}]$. El *out-degree* $d_i^{\text{out}}$ y el *in-degree* $d_i^{\text{in}}$ del nodo $i$ se pueden calcular respectivamente como:
$$
d_i^{\text{out}} = \sum_{j:j\neq i} y_{i,j}
\qquad\text{y}\qquad
d_i^{\text{in}} = \sum_{j:j\neq i} y_{j,i}
$$
Muestre que si la red es no dirigida entonces $d_i^{\text{out}} = d_i^{\text{in}}$.

2. Tanto para redes dirigidas como no dirigidas, se define la media global de las interacciones como
$$
\bar{y}=\frac{1}{n(n-1)}\sum_{i,j:i\neq j} y_{i,j}
$$
donde $\mathbf{Y}=[y_{i,j}]$ es la matriz de adyacencia de la red correspondiente. Tal estadístico corresponde a una descripción muy rudimentaria acerca de la plausibilidad de observar una relación entre dos nodos cualesquiera, dado que no tiene en cuenta la heterogeneidad nodal (algunos nodos son más propensos a enviar/recibir más relaciones).

     a. Muestre que para relaciones no dirigidas la media global $\bar{y}$ es igual a la media tanto de la parte triangular superior de $\mathbf{Y}$ como de la parte triangular inferior de $\mathbf{Y}$.
     b. Muestre que tanto para relaciones dirigidas como no dirigidas la media global corresponde a la densidad de la red.
     c. Muestre que tanto para relaciones dirigidas como no dirigidas se tiene que $(n-1)\bar{y} = \bar{d}^{\text{out}}=\bar{d}^{\text{in}}$. Es decir, el grado promedio tanto de entrada como de salida son iguales y a su vez equivalentes la densidad.

3. Considere un grafo estrella de orden $n$ y un grafo círculo de orden $n$. A continuación se representan ambos grafos para $n=9$. Estos grafos tienen aproximadamente la misma densidad, pero su estructura es muy diferente. 

     a. Muestre que para el grafo círculo  de orden $n$ el grado promedio es $\bar{d} = 2$.
     b. Muestre que para el grafo estrella de orden $n$ el grado promedio es $\bar{d} = 2\frac{n-1}{n} \rightarrow 2$ cuando $n\rightarrow\infty$.

```{r, eval = TRUE, echo=FALSE, out.width="70%", fig.pos = 'H', fig.align = 'center'}
knitr::include_graphics("00_star_circle.png")
```

4. ¿Cuáles de las siguientes secuencias son caminatas en el grafo que se presenta a continuación? ¿Cuáles senderos? ¿Cuáles circuitos? ¿Cuáles ciclos?

     a. $2 - 1 - 6 - 3 - 4$.
     b. $2 - 1 - 6 - 3 - 4 - 1 - 5$.
     c. $2 - 1 - 2 - 5 - 1 - 4$.

```{r, eval = TRUE, echo=FALSE, out.width="25%", fig.pos = 'H', fig.align = 'center'}
knitr::include_graphics("00_wtp.png")
```

5. Considere el conjunto de datos dado en `comtrade.RData` (este archivo contiene una arreglo de tres dimensiones denominado `comtrade`), asociado con el crecimiento anual del comercio (diferencia en dólares en escala logarítmica respecto al año 2000). Este conjunto de datos involucra 30 países, 10 años desde 1996 hasta 2005, y 6 clases de productos diferentes, como se muestra a continuación:

```{r}
load("comtrade.RData")
dimnames(comtrade)[c(1,3,4)]
```

a. Calcule el aumento medio global $\bar{y}$ a lo largo de los 10 años en bienes manufacturados. Para ello considere la matriz de adyacencia `Y` dada por:
```{r}
Y <- apply(X = comtrade[,,c(5,6),], MARGIN = c(1,2), FUN = mean)
```

b. Calcule la media de todas las observaciones de cada fila de `Y`, es decir, calcule la media fila $\bar{y}_{i\bullet}=\frac{1}{n-1}\sum_{j:j\neq i} y_{i,j}$ para cada país. Realice una histograma de los promedios fila $\bar{y}_{i\bullet}$. Los promedios fila caracterizan diferentes niveles de actividad de los nodos en términos de la sociabilidad. ¿Cómo se pueden interpretar los promedios fila $\bar{y}_{i\bullet}$?

c. Calcule la media de todas las observaciones de cada columna de `Y`, es decir, calcule la media columna $\bar{y}_{\bullet j}=\frac{1}{n-1}\sum_{i:i\neq j} y_{i,j}$ para cada país. Realice una histograma de los promedios columna $\bar{y}_{\bullet j}$. Los promedios columna caracterizan diferentes niveles de actividad de los nodos en términos de la popularidad. ¿Cómo se pueden interpretar los promedio columna $\bar{y}_{\bullet j}$?

d. Calcule tanto la media de los promedios fila $\bar{y}_{i\bullet}$ como la media de los promedios columna $\bar{y}_{\bullet j}$.¿Qué se puede concluir acerca de la tendencia local en este caso?

e. Calcule tanto la desviación estándar (DE) de los promedios fila $\bar{y}_{i\bullet}$ como la DE de los promedios columna $\bar{y}_{\bullet j}$. ¿Qué se puede concluir acerca de la heterogeneidad local en este caso?
f. Calcule el coeficiente de correlación (CV) entre los promedios fila $\bar{y}_{i\bullet}$ y los promedios columna $\bar{y}_{\bullet j}$. Realice un dispersograma de los promedios columna $\bar{y}_{\bullet j}$ (eje $y$) frente a los promedios fila $\bar{y}_{i\bullet}$ (eje $x$), junto con la recta $y=x$ como punto de referencia. ¿Qué se puede concluir? 

6.  Considere el conjunto de datos dado en `conflict.RData` recopilado por Mike Ward y Xun Cao del departamento de Ciencias Políticas de la Universidad de Washington, asociado con datos de conflictos entre países en los años 90. El archivo `conflict.RData` contiene una lista con tres arreglos, `X`, `Y`, y `D`. `X` tiene tres campos: `population` (población en millones), `gdp` (PIB en millones de dolares) `polity` (puntuación política, un índice de democracia). `Y` hace referencia a una matriz $\mathbf{Y}=[y_{i,j}]$ en la que $y_{i,j}$ representa el número de conflictos iniciados por el país $i$ hacia el país $j$. Finalmente, `D`es un arreglo de tres dimensiones dimensiones cuya tercera dimensión contiene indices entre cada par de países asociados con: comercio (dimensión 1), importaciones (dimensión 2), organizaciones intergubernamentales (dimensión 3), y distancia geográfica (dimensión 4).

     a. Hacer una visualización decorada de la red de conflictos teniendo en cuenta diferentes diseños.
     c. Calcule e interprete la media global.
     d. Obtenga y grafique la distribución del *out-degree* y del *in-degree*. Calcule e interprete la media y la desviación estándar de esta distribución. 
     e. Calcule el coeficiente de correlación entre los valores del *out-degree* y el *in-degree*. Realice un dispersograma de los grados de entrada (eje $y$) frente a los grados de salida (eje $x$), junto con la recta $y=x$ como punto de referencia. ¿Qué se puede concluir?
     f. Identifique los países mas activos.

7. Para todos los vértices de los cuatro grafos que se presentan a continuación, calcular el grado y las medidas de centralidad. Para cada grafo completar e interpretar la siguiente tabla. Interpretar los resultados.

| Medida | Grado  | Cercanía  | Intermediación | Propia      |
|:------:|:------:|:---------:|:--------------:|:-----------:|
| Media  |        |           |                |             | 
| DE     |        |           |                |             |

```{r, eval = TRUE, echo=FALSE, out.width="25%", fig.pos = 'H', fig.align = 'center'}
knitr::include_graphics("00_four.png")
```


8. Considere los datos relacionales acerca de los conflictos internacionales del archivo `conflict.RData` despúes de simetrizarla débilmente y remover los nodos aislados:

     a. Hacer una visualización decorada de la red.
     b. Caracterizar local y estructuralmente la red, en términos de la distancia, la centralidad, la cohesión, la conectivaidad, y el agrupamento. Utilizar todas las métricas disponbles.
     f. Interpretar los resultados.

9. Sintetizar y replicar los Capítulos 6, 8, y 9 de Luke, D. A. (2015).

10. Para todas las visualizaciones decoradas de este taller, realizar visualizaciones alternativas usando *heat maps* y *hive plots*.

11. Además de la ley de potencias para la distribución del grado, existen alternativas comunes como la distribución log normal, la exponencial, la Poisson y la ley de potencias con corte exponencial. Caracterizar cada una de estas opciones de manera detallada y concisa, describiendo su forma y la intuición que representa en términos de heterogeneidad y presencia de nodos altamente conectados. Explicar para qué sirve modelar la distribución del grado, en qué contextos resulta apropiado usar cada familia, y cuáles son sus principales ventajas y desventajas desde el punto de vista interpretativo y empírico. Seleccionar una de estas distribuciones y ejemplificar su uso con un conjunto de datos real de su elección, incluyendo una evaluación del ajuste y una interpretación de los resultados.

12. Además del grado, la centralidad por cercanía, la centralidad por intermediación y la centralidad propia, existen otras medidas relevantes para cuantificar la importancia de los nodos en una red. En el caso de redes no dirigidas, caracterizar de manera detallada y concisa las medidas *PageRank*, *Katz centrality*, *Harmonic centrality* y *VoteRank*, incluyendo la intuición estadística que las motiva y el tipo de estructura que cada una prioriza. Luego, con base en el conjunto de datos real utilizado en el numeral anterior, calcular estas medidas para todos los nodos, presentar los principales resultados, comparar los rankings obtenidos e interpretar las diferencias observadas en términos de la estructura de la red y del rol de los nodos más destacados.

 



# Referencias {-}

**Luke, D. A. (2015). A user's guide to network analysis in R. New York: Springer.** https://link.springer.com/book/10.1007/978-3-319-23883-8